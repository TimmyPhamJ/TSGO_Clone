<%
if(locals.ordInfo && locals.ordInfo[0]){
%>
<!DOCTYPE html>
<html lang="vn">
<meta charset="UTF-8">
<meta name="viewport" content="width=1280, maximum-scale=3.0, initial-scale=1, minimum-scale=0.1" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<title>Phiếu </title>
<style>
	.tblif{
		border-collapse: collapse;
		border: none;
	}
	.tblif th,.tblif td{
		border: 0.1px solid #111;
	}
	#tablecontent tr th:nth-child(5),#tablecontent tr td:nth-child(5){
		display: none;
	}
	.ibox-body.set-p0{
		padding-top: 0px;
	}
	.ibox-body.set-p0 label{
		font-weight: bold;
	}
	.ibox-body.set-p0 .row.my-box.pb-1 {
		border:none !important;
		box-shadow: none;
	}
	.ibox-body.set-p0 span[role='combobox']{width: 100%;}
	.giaya4{
		width: 800px;
		min-height: 400px !important;
		width: 21cm;
        margin: 0;
		background: #fff;
		border: 1px solid #b6b6b6;
		text-align: left;
		display: inline-block;
		box-sizing: border-box;
		padding:25px;
		position:relative;
	}
	body{
		background: #e3e3e3;
	}
	.mainroot{
		text-align: center;
		padding-top: 50px;

	}
	html{
		font-size:14px;
	}
	table{width:100%;}
	.Lbit{
		font-weight:bold;
	}
*{box-sizing:border-box;z-index:11;}
.giaya4 .overlay{
	display:flex;
	text-align:center;
	position:absolute;
	left:0px;
	top:0px;
	width:100%;
	height:100%;
	opacity: 0.3;
	z-index:22;
	align-items: center;
    justify-content: center;
}
html *{
		font-size:1rem;
	} 
	@media print {
		html{
			font-size: 10px !important;
		}
		@page { size: A5 portrait;
			width: 21cm;
        height: 29.7cm;
        margin: 0; }
		body { margin: 0px; }
		.giaya4 {
			background-color: white;
			height: 100%;
			width: 100%;
			margin: 0;
			padding: 25px;
			border: none;
			position:absolute;
			left:0px;
			top:0px;
		}
		.tblif{
			border-collapse: collapse;
			width: 100%;
		}
		.boxin{display: none;}
		#barcode{float: right;}
	}
</style>
<script type="text/javascript">
	
</script>
<div class="row">
	<div class="col-xl-12">
		<div class="page-content fade-in-up mainroot pt-5">
			<div class=boxin><div class="fa fa-print" id=in_phieu onClick="window.print();" style="position:absolute;top:0.4rem;left:0.4rem;padding:5px 0.4rem;border:1px solid #b6b6b6;background:#fff;"> In Phiếu</div></div>
		
			<div class="text-center">
			<div class="giaya4" id="giaya4">
				<div class="overlay" >
					<img style="width:30%;height:auto;max-width: 100%;" src="/assets/img/logos/logo-csg.png">
				</div>
				<div class="col-12 p-0 m-0">
					<div class="row col-12 p-0 m-0">
						<table border=0 collapse=0 >
							<tr>
								<td width="8%" rowspan=2 align="left" valign="top" style="position:relative">
									<%- locals.terminalInfo[0].HTMLLogo %>
								</td>
								<td width="72%">
									<div style="text-align:left;">
										<div style="font-size:1.3rem;font-weight:bold;text-align: center;"><%= locals.terminalInfo[0].TerminalName %></div>
										<div style="font-size:1.1rem;text-align: center;" >Địa chỉ: <%= locals.terminalInfo[0].Address %></div>
										<div style="font-size:1.1rem;text-align: center;" >Điện thoại: <%= locals.terminalInfo[0].Tel %> - Fax: <%= locals.terminalInfo[0].Fax %></div>
										<div style="font-size:1.1rem;text-align: center;" >Email: <%= locals.terminalInfo[0].Email %></div>
									</div>
								</td>	
							</tr>
							<tr>	
								<td width="50%" >
									<div style="text-align:center;text-transform:uppercase;">
										<div style="font-size:1.4rem;font-weight:bold;color:red;">Phiếu giao nhận hàng</div>
										<div style="font-weight:bold;">Equipment interchange receipt</div>
									</div>
								</td>	
							</tr>
						</table>
					
					</div>

                    <div style="padding:0.4rem;display: flex;">
						<div style="width:60%;display:inline-block;">
							<div class="Lbit">Phương án: <%= locals.ordInfo[0].JobModeName %></div>
							<div>(Delivering / Receiving task)</div>
							
						</div>
						<div style="width:40%;display:inline-block;">
							<div class="Lbit">Phương thức: <%= locals.ordInfo[0].MethodName %></div>
							<div>(Method)</div>
						</div>
					</div>
					<div style="padding:0.4rem;">
						<div style="width:100%;display:inline-block;">
							<div class="Lbit">Chủ hàng: <%= locals.ordInfo[0].CusName %></div>
							<div>(Customer)</div>
						</div>
					</div>
					<div style="padding:0px 0.4rem;padding-bottom:10px;display: flex;">
						<div style="width:60%;display:inline-block;">
							<div class="Lbit">Tàu chuyến: <%= locals.ordInfo[0].VesselName %> / <%= locals.ordInfo[0].InboundVoyage %> / <%= locals.ordInfo[0].OutboundVoyage %></div>
							<div>(Vessel Voyage)</div>
						</div>
						<div style="width:40%;display:inline-block;">
							<div class="Lbit">Ngày cập: <%= locals.ordInfo[0].ATB %></div>
							<div>(ATB)</div>
						</div>
					</div>
					
                    <div style="padding-top:10px;padding-bottom:10px;">
                        <table class="tblif" border="0" cellpadding="5x" cellspacing="0px">
                            <thead>
                                <tr>
                                    <th rowspan="2" align="center" width="150px">VẬN ĐƠN/BOOKING</th>
                                    <th rowspan="2" align="center" width="200px">HÀNG HÓA</th>
                                    <th align="center" width="80px">SỐ LƯỢNG</th>
                                    <th align="center" width="80px">TL BQ</th>
                                    <th rowspan="2" align="center" width="40px">ĐVT</th>
                                    <th rowspan="2" align="center" width="80px">VỊ TRÍ</th>
                                </tr>
                                <tr>
                                    <th align="center">SL (pcs)</th>
                                    <th align="center">(pcs/tấn)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <%
								let tongQ=0;
								let tongW=0;
                                locals.ordInfo.map((itm,ii)=>{
									tongQ+=itm.Quantity;
									tongW+=(itm.McWeight||itm.CargoWeight||0);
                                    %>
                                    <tr>
                                        <td><%= (itm.BookingNo||'')+(itm.BBNo||'') %></td>
                                        <td><%= (itm.ItemName||'') %></td>
                                        <td align="right"><%= (itm.Quantity||'') %></td>
                                        <td align="right"><%= (itm.McWeight||itm.CargoWeight||0).toFixed(3) %></td>
                                        <td align="center"><%= (itm.UnitID||'') %></td>
                                        <td align="center"><%= (itm.Blocks||'') %></td>
                                    </tr>
                                    <%
                                })
                                %>
								<tr>
									<td colspan="2" align="center"><b>TỔNG CỘNG</b></td>
									<td align="right"><%= tongQ %></td>
									<td align="right"><%= tongW.toFixed(3) %></td>
									<td align="center"></td>
									<td align="center"></td>
								</tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- <% if(locals.blocks) { %>
                    <div style="padding-top:10px;padding-bottom:10px;">
                        <table border="0" cellpadding="5x" cellspacing="0px">
                            <tbody>
                                
                                <%
                                Object.keys(locals.blocks).map((itm,ii)=>{
                                    %>
                                    <tr>
                                        <% if(ii==0) { %>
                                            <td rowspan="<%= Object.keys(locals.blocks).length %>" align="center"  width="200px">Vị trí lưu hàng</td>
                                        <% } %>
                                        <td width="300px"><%= (itm) %></td>
                                        <td><%= Object.keys(locals.blocks[itm]).join(', ') %></td>
                                    </tr>
                                    <%
                                })
                                %>
                            </tbody>
                        </table>
                    </div>
					<% } %> -->
					<div style="position:relative;padding:0px;display: flex;height: 160px;">
						<div style="padding:5px;width:50%;display:inline-block;text-align:center;height:100%">
							<div style="font-weight:bold;font-size:1.2rem">Nhân viên kho hàng</div>
                            <div>(Issuer)</div>                            
						</div>
						<div style="padding:5px;width:50%;display:inline-block;text-align:center;height:100%">
							<div style="font-weight:bold;font-size:1.2rem">Chủ hàng</div>
							<div>(Customer)</div>
						</div>						
					</div>
		</div>
		</div>
	</div>
</div>
</div>
</div>


<script>
	$(document).ready(function(){
		if(window.location.hash){
			window.print();
			setTimeout(()=>{
				window.close();
			},2000);			
		}
		var gh=$("#giaya4").outerHeight();
		if(gh>1123)
		{
			alert(2);
		}
	});
</script>
</html>
<%
}
else{
%>
<!DOCTYPE html>
<html lang="vn">
<meta charset="UTF-8">
<script>
	alert('Phiếu không thể in , hoặc không tồn tại !!');
	setTimeout(()=>{
		window.close();
	},100);
</script>
</html>
<%
}
%>
