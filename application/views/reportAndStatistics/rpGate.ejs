<script>document.title = 'BÁO CÁO CỔNG'</script>
<link href="/assets/vendors/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet" />
<style>
	@media (max-width: 767px) {
		.f-text-right    {
			text-align: right;
		}
	}
	.no-pointer{
		pointer-events: none;
	}
	.ibox .ibox-footer {
	    padding: 10px 25px 5px 25px;
	}
	.modal_input{
		border-bottom: dotted 1px; 
		width: 70%;
	}
	.cash_input{
		border-bottom: dotted 1px; 
		width: 60%;
	}
	label{
		padding-right: 0px!important;
	}

	#contenttable_wrapper .dataTables_scroll #cell-context-1 .dropdown-menu .dropdown-item .sub-text,
	#contenttable_wrapper .dataTables_scroll #cell-context-2 .dropdown-menu .dropdown-item .sub-text,
	#contenttable_wrapper .dataTables_scroll #cell-context-3 .dropdown-menu .dropdown-item .sub-text,
	#contenttable_wrapper .dataTables_scroll #cell-context-4 .dropdown-menu .dropdown-item .sub-text,
	#contenttable_wrapper .dataTables_scroll #cell-context-5 .dropdown-menu .dropdown-item .sub-text,
	#contenttable_wrapper .dataTables_scroll #cell-context-6 .dropdown-menu .dropdown-item .sub-text,
	#contenttable_wrapper .dataTables_scroll #cell-context-7 .dropdown-menu .dropdown-item .sub-text{
		margin-left: 7px;
		font-size: 12px;
		font-style: italic;
	}
</style>

<div class="row">
	<div class="col-xl-12" style="font-size: 12px;">
		<div class="ibox collapsible-box">
			<i class="la la-angle-double-up dock-right"></i>
			<div class="ibox-head">
				<div class="ibox-title">BÁO CÁO CỔNG</div>
			</div>
			<div class="ibox-body pt-0 pb-0 bg-f9 border-e">
				<div class="row ibox mb-0 border-e pb-1 pt-1">
					<div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12 mt-3">
						<div class="row" id="row-transfer-left">

							<div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                <div class="row form-group">
									<label class="col-sm-4 col-form-label">Ngày lệnh</label>
									<div class="col-sm-8 input-group input-group-sm">
										<div class="input-group">
											<input class="form-control form-control-sm input-required" readonly="readonly" id="IssueDate" type="text" placeholder="Ngày lệnh">
										</div>
									</div>
								</div>		

								<div class="row form-group">
									<label class="col-sm-4 col-form-label">Hạn lệnh</label>
									<div class="col-sm-8 input-group input-group-sm">
										<div class="input-group">
											<input class="form-control form-control-sm input-required" id="ExpDate" type="text" placeholder="Hạn lệnh">
										</div>
									</div>
								</div>

							</div>
							<div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12">

                                <div class="row form-group">    
									<input id="VoyageKey" class="form-control form-control-sm" type="text" hidden>
									<label class="ml-1" style="width: 5.5rem; margin-top: 0.4rem">Thông tin tàu</label>		
									<input id="VesselName" placeholder="Tên tàu | Chuyến nhập | Chuyến xuất" style="border-radius: 5px; margin-left: 1rem; padding-left: 7.5px; border-color: rgba(0, 0, 0, .1); border-width: 1px; height: 2rem; width: 16.5rem" type="text">
									<!-- -->
									<button id="chooseVessel" class="btn btn-success btn-icon-only btn-circle btn-sm btn-air ml-2" style="height: 1.65rem; width: 1.65rem" title="Chọn tàu">
										<i class="ti-plus"></i>
									</button>
									<button id="nochooseVessel" class="btn btn-danger btn-icon-only btn-circle btn-sm btn-air ml-2" style="height: 1.65rem; width: 1.65rem" title="Bỏ chọn">
										<i class="ti-close"></i>
									</button>
								</div>	
                               
                                <div class="row form-group">
									<label class="ml-1" style="width: 5.5rem; margin-top: 0.4rem">Số vận đơn</label>
									<div class="col-sm-8 input-group input-group-sm" style="width: calc(100% - 6.5rem) !important;min-width: calc(100% - 6.5rem) !important;max-width: calc(100% - 6.5rem) !important;">
										<div class="input-group">
											<input class="form-control form-control-sm input-required" readonly="readonly" id="IssueDate" type="text" placeholder="Số vận đơn">
										</div>
									</div>
								</div>

							</div>
						</div>
					</div>
					<div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12 mt-3">
						<div class="row">
							<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12">
								<div class="row form-group" style="border-bottom: 1px solid #eee">
									<div class="col-12 col-form-label">
										<label class="checkbox checkbox-blue">
											<input type="checkbox" name="chkServiceAttach" id="chkServiceAttach">
											<span class="input-span"></span>
											Đính kèm dịch vụ
										</label>
									</div>
								</div>
							</div>
						</div>
						<div class="row pl-1" id="row-transfer-right">
							<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-1" id="col-transfer">
								<div class="row form-group">
									<label class="col-sm-2 col-form-label pr-0">Đại diện</label>
									<div class="col-sm-10 input-group">
										<input class="form-control form-control-sm mr-1" id="cmnd" type="text" placeholder="Số CMND/ Số ĐT">
										<input class="form-control form-control-sm mr-1" id="personal-name" type="text" placeholder="Họ tên người đại diện">
										<input class="form-control form-control-sm" id="Email" type="text" placeholder="Địa chỉ Email *" style="width: 5rem">
									</div>
								</div>	
                                <div class="row form-group">
									<label class="col-sm-2 col-form-label">Ghi chú</label>
									<div class="col-sm-10">
									<input class="form-control form-control-sm input-required" id="remark" type="text" placeholder="Ghi chú">
									</div>
								</div>							
							</div>
						</div>
					</div>
				</div>
			</div>
            
			<div class="ibox-body pt-0 pb-0 bg-f9 border-e">
				<div class="row ibox mb-0 border-e pb-0 pt-0">
					<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-2">
						<div class="row">

							<div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 pb-0">
								<div class="row form-group">
									<label class="col-sm-4 col-form-label" title="Đ.tượng thanh toán">Đối tượng TT *</label>
									<div class="col-sm-8 input-group">
										<input class="form-control form-control-sm input-required" id="tax_code" placeholder="Đối tượng thanh toán" type="text">
										<span class="input-group-addon bg-white btn mobile-hiden text-warning" style="padding: 0 .5rem" title="Chọn đối tượng thanh toán" data-toggle="modal" data-target="#payer-modal" id="chooseCustomer">
											<i class="ti-search"></i>
										</span>
									</div>
									<input class="hiden-input" id="TaxCode" readonly="">
									<input class="hiden-input" id="PaymentTypeID" hidden>
									<input class="hiden-input" id="CusTypeID" hidden>
								</div>

                                <div class="row form-group">
									<label style="background-color: transparent;" class="col-sm-4 col-form-label" title="Đ.tượng thanh toán">Hình thức TT *</label>
									<div class="col-sm-8 input-group">
										<select id="MoneyCredit" style="width: 100%;
                                        color: #495057;
                                        background-color: #fff;
                                        background-image: none;
                                        background-clip: padding-box;
                                        border: 1px solid rgba(0,0,0,.15);
                                          border-top-color: rgba(0, 0, 0, 0.15);
                                          border-right-color: rgba(0, 0, 0, 0.15);
                                          border-bottom-color: rgba(0, 0, 0, 0.15);
                                          border-left-color: rgba(0, 0, 0, 0.15);
                                        border-top-color: rgba(0, 0, 0, 0.15);
                                        border-right-color: rgba(0, 0, 0, 0.15);
                                        border-bottom-color: rgba(0, 0, 0, 0.15);
                                        border-left-color: rgba(0, 0, 0, 0.15);
                                        border-radius: .25rem;
                                        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s">
                                            <option value="M">Thu Ngay</option>
                                            <option value="C">Thu Sau</option>
                                        </select>
									</div>
								</div>
                                
                                
							</div>

							<div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-xs-2 col-form-label mt-1">

								<i class="fa fa-id-card" style="font-size: 15px!important;"></i> - <span id="CusName"> [Tên đối tượng thanh toán]</span>&emsp;

								
                                <br>
                                <br>

                                <i class="fa fa-home" style="font-size: 15px!important;"></i> -<span id="Address"> [Địa chỉ]</span>&emsp;

							</div>

                            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 pb-0">
								<div class="row form-group">
									<label class="col-sm-4 col-form-label" title="Đ.tượng thanh toán">Số Hợp Đồng *</label>
									<div class="col-sm-8 input-group">
										<select id="NoContact" style="width: 100%;
                                        color: #495057;
                                        background-color: #fff;
                                        background-image: none;
                                        background-clip: padding-box;
                                        border: 1px solid rgba(0,0,0,.15);
                                          border-top-color: rgba(0, 0, 0, 0.15);
                                          border-right-color: rgba(0, 0, 0, 0.15);
                                          border-bottom-color: rgba(0, 0, 0, 0.15);
                                          border-left-color: rgba(0, 0, 0, 0.15);
                                        border-top-color: rgba(0, 0, 0, 0.15);
                                        border-right-color: rgba(0, 0, 0, 0.15);
                                        border-bottom-color: rgba(0, 0, 0, 0.15);
                                        border-left-color: rgba(0, 0, 0, 0.15);
                                        border-radius: .25rem;
                                        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s">
                                            <option value="M">{value}</option>
                                        </select>
									</div>
								</div>
							</div>

                            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 col-xs-4 col-form-label mt-1">
                                <b>Đơn vị tính</b>
                                <label class="radio radio-outline-success pr-4">
                                    <input name="unit-opt" type="radio" id="chk-view-cont" value="QTY" checked="">
                                    <span class="input-span"></span>
                                    Số lượng
                                </label>
                                <label class="radio radio-outline-success pr-4">
                                    <input name="unit-opt" id="chk-view-cont" value="WEIGHT" type="radio">
                                    <span class="input-span"></span>
                                    Trọng lượng
                                </label>
                                <label class="radio radio-outline-success pr-4">
                                    <input name="unit-opt" id="chk-view-cont" value="M3" type="radio">
                                    <span class="input-span"></span>
                                    Mét khối
                                </label>
                            </div>
						</div>
					</div>
				</div>
			</div>

			<div class="ibox-body pt-0 pb-0 bg-f9 border-e">
				<div class="row ibox mb-0 border-e pb-0 pt-0">
					<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-2">
						<div class="row">

							<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6">
								<div class="row form-group ml-auto">						

									<button id="removeRow" class="btn btn-outline-danger btn-sm mr-1" title="Xóa những dòng đang chọn">
										<span class="btn-icon"><i class="fa fa-trash"></i>Xóa dòng</span>
									</button>

                                    <button id="importFile" class="btn btn-outline-secondary btn-sm mr-1" 
										title="Lấy dữ liệu MNF">
										<span class="btn-icon"><i class="fa fa-download"></i>Lấy dữ liệu MNF</span>
									</button>

                                    <div class="ml-3 mt-2">
										<label class="mt-1 radio radio-info">
			                                <input type="radio" name="ClassID" class="css-checkbox" value="1"checked/>
			                                <span class="input-span"></span>Khai Báo
			                            </label>	
										<label class="mt-1 ml-3 radio radio-info">
			                                <input type="radio"  name="ClassID" class="css-checkbox" value="2" />
			                             	<span class="input-span"></span>Thực Tê
			                            </label>			                            
			                        </div>

								</div>
							</div>

							<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6">
								<div class="row form-group" style="display: inline-block; float: right; margin: 0 auto">
									<label class="mt-1 ml-5 radio radio-info">
										<input type="radio" name="IsLocalForeign" class="css-checkbox" value="L" />
										<span class="input-span"></span><span style="margin-left: 0;">Danh sách hàng rời</span>
									</label>	
									<label class="mt-1 ml-3 radio radio-info">
										<input type="radio" checked name="IsLocalForeign" class="css-checkbox" value="F" />
										<span class="input-span"></span>Tính Cước
									</label>
									<button id="show-payment-modal" class="btn btn-warning btn-sm" title="Thông tin thanh toán" data-toggle="modal">
										<i class="fa fa-print"></i>
										Thanh toán
									</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="row ibox-footer border-top-0">
				<div class="col-md-12 col-sm-12 col-xs-12 table-responsive" id="Table1">
					<table id="contenttable" class="table table-striped display nowrap" cellspacing="0">
						<thead>
						
						</thead>
						<tbody>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
 </div>

 
<!-- Customer modal-->
<div class="modal fade" id="customer-modal" tabindex="-1" role="dialog" aria-labelledby="groups-modalLabel-2" aria-hidden="true" data-whatever="id" style="padding-left: 14%; margin-top: 5em;">
	<div class="modal-dialog" role="document" style="min-width: 1024px!important">
		<div class="modal-content" style="border-radius: 4px">
			<div class="modal-header">
				<h5 class="modal-title text-primary" id="groups-modalLabel-2">DANH MỤC KHÁCH HÀNG</h5>
			</div>
			<div class="modal-body">
				<table id="tblCustomer" class="table table-striped display nowrap" cellspacing="0" style="width: 99.5%"></table>
			</div>
			<div class="modal-footer">
				<div  style="margin: 0 auto!important;">
					<button class="btn btn-sm btn-rounded btn-gradient-blue btn-labeled btn-labeled-left btn-icon" id="apply-customer">
						<span class="btn-label"><i class="ti-check"></i></span>Xác nhận</button>
					<button class="btn btn-sm btn-rounded btn-gradient-peach btn-labeled btn-labeled-left btn-icon" data-dismiss="modal">
						<span class="btn-label"><i class="ti-close"></i></span>Đóng</button>
				</div>
			</div>
		</div>
	</div>
</div>
 <!-- Vessel modal-->
<div class="modal fade" id="vessel-modal" tabindex="-1" role="dialog" aria-labelledby="groups-modalLabel-1" aria-hidden="true" data-whatever="id" style="padding-left: 2%; padding-top: 2%">
	<div class="modal-dialog" role="document" style="min-width: 1024px!important">
		<div class="modal-content" style="border-radius: 4px">
			<div class="modal-header">
				<h5 class="modal-title text-primary" id="groups-modalLabel-1">Danh mục tàu</h5>
				<button id="VesselSearch" class="btn btn-outline-warning btn-sm btn-loading mr-1" 
									data-loading-text="<i class='la la-spinner spinner'></i>Nạp dữ liệu"
								 	title="Nạp dữ liệu">
					<span class="btn-icon"><i class="ti-search"></i>Nạp dữ liệu</span>
				</button>
			</div>
			<div class="modal-body" style="padding: 0px 15px 15px 15px">
				<div class="row mb-0 border-e border-top-0 pb-1 pt-3">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
							<div class="row">
								<div class="col-lg-4 col-md-4 col-sm-6 col-xs-6">
									<div class="row form-group">
										<label class="col-md-2 col-sm-4 col-xs-4 col-form-label">Tàu</label>
										<input id="VesselNameFilter" class="col-md-8 col-sm-10 col-xs-10 form-control form-control-sm" placeholder="Tên tàu" type="text">
									</div>
								</div>
								<div class="col-lg-4 col-md-4 col-sm-6 col-xs-6">
									<div class="row form-group">
										<label class="col-md-2 col-sm-2 col-xs-2 col-form-label">Năm</label>
										<div class="col-md-8 col-sm-10 col-xs-10 input-group input-group-sm">
											<select id="YearFilter" data-width="100%" data-style="btn-default btn-sm"
													title="Năm"
													style="width: 80%; border-radius: 2px; border-color: rgba(0, 0, 0, .1);">
												<% for (let i = 2016; i < 2026; i++){ %>
													<option value="<%= i %>">
														<%= i %>		
													</option>
												<% } %>												
											</select>
										</div>										
									</div>
								</div>
								<div class="col-lg-4 col-md-4 col-sm-6 col-xs-6">
									<div class="row form-group">
										<label class="radio radio-success ml-5 mt-1">
					                        <input type="radio" checked name="VesselFilter" class="css-checkbox" value="1" />
					                            <span class="input-span"></span>Đến cảng
					                    </label>								

										<label class="radio radio-success ml-3 mt-1 mr-3">
					                       <input type="radio" name="VesselFilter" class="css-checkbox" value="2" />
					                            <span class="input-span"></span>Rời cảng
					                    </label>   
									</div>
								</div>
							</div>
					</div>
				</div>
				<div class="row ibox-footer border-top-0 mt-3">
					<div class="col-md-12 col-sm-12 col-xs-12 table-responsive">
						<table id="tblVessel" class="table table-striped display nowrap" cellspacing="0" style="width: 99.5%">
							<thead>
								<tr style="width: 100%">
									<th col-name="STT">STT</th>
									<th col-name="VoyageKey"></th>
									<th col-name="VesselID">Mã tàu</th>
									<th col-name="VesselName">Tên tàu</th>
									<th col-name="InboundVoyage">Chuyến nhập</th>
									<th col-name="OutboundVoyage">Chuyến xuất</th>
									<th col-name="ETA">ETA</th>
									<th col-name="ETD">ETD</th>
									<th col-name="Status">Status</th>
									<th col-name="InLane">Lane nhập</th>
									<th col-name="OutLane">Lane xuất</th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<div  style="margin: 0 auto!important;">
					<button class="btn btn-sm btn-rounded btn-gradient-blue btn-labeled btn-labeled-left btn-icon" id="apply-vessel" data-dismiss="modal">
						<span class="btn-label"><i class="ti-check"></i></span>Xác nhận</button>
					<button class="btn btn-sm btn-rounded btn-gradient-peach btn-labeled btn-labeled-left btn-icon" data-dismiss="modal">
						<span class="btn-label"><i class="ti-close"></i></span>Đóng</button>
				</div>
			</div>
		</div>
	</div>
</div>

 <!-- <script> //Chosse date
 
	var d = new Date();
		$("#IssueDate").val(moment().format('YYYY-MM-DD HH:mm:ss'));
		$("#ExpDate").val(moment().endOf('day').format('YYYY-MM-DD HH:mm:ss'));

		$("#del-ref-exp-date").on('click', function(){
			$("#ExpDate").val('');
		});

		$('#ExpDate').datepicker({
			controlType: 'select',
			oneLine: true,
			dateFormat: 'yy-mm-dd',	
            onSelect: function(dateText) {
                $(this).val(moment(dateText).endOf('day').format('YYYY-MM-DD HH:mm:ss'))
            }
		});
		
 </script> -->

<script type="text/javascript">
    $(document).ready(function () {
        var _columns = [
                { width: "80px", data: "STT", name: "STT", title: "STT", className: "text-center  editor-cancel", targets: 0 },
                { data: "ClassID", name: "ClassID", title: "Nhập/ Xuất", className: "text-center", targets: 1 },
                { data: "ClassID", name: "ClassID", title: "BL/ BK", className: "text-center ", targets:2 },
                { data: "IsLocalForeign", name: "IsLocalForeign", title: "Hàng hóa", className: "text-center ", targets:3 },
                { data: "POL", name: "POL", title: "Nhóm hàng", className: "text-center ", targets:4 },
                { data: "POD", name: "POD", title: "Số lượng khai báo", className: "text-center ", targets:5 },
                { data: "FPOD", name: "FPOD", title: "Trọng lượng khai báo", className: "text-center ", targets:6 },
                { data: "TransitID", name: "Thể tích khai báo", title: "Thể tích khai báo", className: "text-center ", targets:7 },
				{ data: "CargoWeight", name: "CargoWeight", title: "Số lượng thực tế", className: "text-center ", targets:8 },
                { data: "UnitID", name: "UnitID", title: "Trọng lượng thực tế",className: "text-center ", targets:9 },
                { data: "CommodityDescription", name: "CommodityDescription", title: "Thể tích thực tế", className: "text-center ", targets:10 },
                { data: "CommodityDescription", name: "CommodityDescription", title: "ĐVT", className: "text-center ", targets:11 },
                { data: "CommodityDescription", name: "CommodityDescription", title: "Loại hình", className: "text-center ", targets:12 },
                { data: "CommodityDescription", name: "CommodityDescription", title: "Phương án vào", className: "text-center ", targets:13 },
                { data: "CommodityDescription", name: "CommodityDescription", title: "Phương thức vào", className: "text-center ", targets:14 },
                { data: "rowguid", name: "rowguid", title: "rowguid", visible: false, targets: 15 },
            ],
            TblContent = $('#contenttable'),
            dataList = <%- JSON.stringify(locals.dataList || []) %>;
        var dataTbl = TblContent.newDataTable({
            scrollY: '55vh',
            columnDefs: _columns,
            data: [],
            order: [[0, 'asc']],
            paging: false,
            keys: true,
            autoFill: {
                focus: 'focus',
            },
            select: true,
            rowReorder: false
        });
	});
</script>

<!-- <script>
	$(document).ready(function () {
		var _vesselColumns 	= ["STT", "VoyageKey", "VesselID", "VesselName", "InboundVoyage", "OutboundVoyage", "ETA", "ETD", "Status", "InLane", "OutLane"],
			tblVessel 		= $("#tblVessel"),
			vesselModal 	= $("#vessel-modal");

		/* Initial vessel table */	
		tblVessel.newDataTable({
			scrollY: '30vh',
			columnDefs: [
				{ type: "num", className: "text-center", targets: _vesselColumns.indexOf('STT')},		
				{ className: "text-center", targets: _vesselColumns.getIndexs(["VesselName", "InboundVoyage", "OutboundVoyage", "ETA", "ETD", "InLane", "OutLane"])},
				{ className: "hiden-input", targets: _vesselColumns.getIndexs(["VoyageKey", "VesselID", "Status"])},
			],
			order: [[ _vesselColumns.indexOf('STT'), 'asc' ]],
			paging: false,
			keys:true,
			autoFill: {
				focus: 'focus'
			},
			select: {
				style: 'single',
				info: false,
			},
			buttons: [],
			rowReorder: false,
			arrayColumns: _vesselColumns,
		});

		$('#vessel-modal').on('shown.bs.modal', function(e){
			$($.fn.dataTable.tables(true)).DataTable().columns.adjust();
		});

		$("#VesselSearch").on('click', function(){
			tblVessel.waitingLoad();
			var formData = {
				filter:{
					Status: $("input[type='radio'][name='VesselFilter']:checked").val(),
					VesselName:{
						operation: 'like',
						value: $('#VesselNameFilter').val()
					}
				}
			};			

			$.ajax({
				url: "/Order/ordDelivery/loadVesselVisit",
				dataType: 'json',
				data: formData,
				type: 'POST',
				success: function (data) {
					var rows = [];
					tblVessel.dataTable().fnClearTable();
					if(data.data.length > 0) {
						for (i = 0; i < data.data.length; i++) {
							var rData = data.data[i], r = [];
							$.each(_vesselColumns, function(idx, colname){
								var val = "";
								switch(colname){
									case "STT": 
										val = i+1; 
										break;
									case "ETA":
									case "ETD":
										val = getDateTime(rData[colname]);
										break;
									default:
										val = (rData[colname] ? rData[colname] : '');
										break;	
								}
								r.push(val);
							});
							rows.push(r);
						}
					}
					tblVessel.dataTable().fnClearTable();
					if(rows.length > 0){
						tblVessel.dataTable().fnAddData(rows);
					}
				
				},
				error: function(err){
					tblVessel.dataTable().fnClearTable();
					console.log(err);
				}
			});
		});

		$("#chooseVessel").on('click', function(){
			$('#vessel-modal').modal("show");
			$('#VesselSearch').trigger('click');
			sumNumRows = 0;
			$("#YearFilter").val(new Date().getFullYear());

		});	

		$("#nochooseVessel").on('click', function(){
			$('#inputManifestForm').trigger("reset");
			tbl.dataTable().fnClearTable();
			$("#VesselName").val('');
			$("#InboundVoyage").val('');
			$("#OutboundVoyage").val('');
			$("#ETA").val('');
			$("#ETD").val('');
		});

     		$("#InboundVoyage").val(InboundVoyage);
       		$("#OutboundVoyage").val(OutboundVoyage);
       		$("#ETA").val(ETA);
       		$("#ETD").val(ETD);

       		$('#search').trigger('click');
       		vesselModal.modal('hide');
       	});

		$("#apply-vessel").on("click", function(){
       		var tblVesselSelectedRows = tblVessel.getSelectedRows().data().toArray()[0];
       			VoyageKey		= tblVesselSelectedRows[_vesselColumns.indexOf("VoyageKey")],
       			VesselName 		= tblVesselSelectedRows[_vesselColumns.indexOf("VesselName")],
       			InboundVoyage 	= tblVesselSelectedRows[_vesselColumns.indexOf("InboundVoyage")],
       			OutboundVoyage 	= tblVesselSelectedRows[_vesselColumns.indexOf("OutboundVoyage")],
       			InLane 			= tblVesselSelectedRows[_vesselColumns.indexOf("InLane")],
       			OutLane 		= tblVesselSelectedRows[_vesselColumns.indexOf("OutLane")],
       			ETA 			= tblVesselSelectedRows[_vesselColumns.indexOf("ETA")],
       			ETD 			= tblVesselSelectedRows[_vesselColumns.indexOf("ETD")];

       		$("#VoyageKey").val(VoyageKey);
       		$("#VesselName").val(VesselName + " | " + InboundVoyage + " | " + OutboundVoyage);
       		$("#InboundVoyage").val(InboundVoyage);
       		$("#OutboundVoyage").val(OutboundVoyage);
       		$("#ETA").val(ETA);
       		$("#ETD").val(ETD);

       		$('#search').trigger('click');
       		vesselModal.modal('hide');
       	});
       	
       	$('#search').on("click", function(){
			/* Load data to datatable */
			// Get data input
			var btn 					= $(this),
				VoyageKey				= $("#VoyageKey").val(),
				IsLocalForeign			= $("input[name='IsLocalForeign']:checked").val(),
				ClassID					= $("input[name='ClassID']:checked").val();

			if (VoyageKey == ''){
				toastr['error']('Vui lòng chọn tàu trước khi load dữ liệu!');
				return;
			}

			var formData = {
				filter:{
					'VoyageKey': 				VoyageKey,
					//'IsLocalForeign': 			IsLocalForeign,
					//'ClassID': 					ClassID,
				}
			};

			TblConten.waitingLoad();

			$.ajax({
				url: "/Order/ordDelivery/get",
				dataType: 'json',
				data: formData,
				type: 'POST',
				success: function (data) {
					var rowsIn = [], rowsOut = [], index1 = 1, index2 = 1;
					if(data.data.length > 0) {
						for (i = 0; i < data.data.length; i++) {
							var rData = data.data[i], r = [];
							if (data.data[i]['ClassID'] == 1){
								$.each(_columns, function(idx, colname){
									var val = "";
									switch(colname){
										case "STT": 
											val = index1++;
											break;
										case "IsLocalForeign":
											if (rData[colname] == 'L')
												val='<input class="hiden-input" value="L">' + "Nội";
											else
												val='<input class="hiden-input" value="F">' + "Ngoại";
											break;
										case "ClassID":
											if (rData[colname] == 1)
												val='<input class="hiden-input" value="1">' + "Nhập";
											else
												val='<input class="hiden-input" value="2">' + "Xuất";
											break;
										case "JobModeID":
											val = (rData[colname] == null) ? '' : '<input class="hiden-input" value="' + rData[colname] + '">' + rData['JobModeName'];
											break;
										case "MethodID":
											val = (rData[colname] == null) ? '' : '<input class="hiden-input" value="' + rData[colname] + '">' + rData['MethodName'];
											break;
										case "UnitID":
											val = (rData[colname] == null) ? '' : '<input class="hiden-input" value="' + rData[colname] + '">' + rData['UnitName'];
											break;
										default:
											val = (rData[colname] == null) ? '' : rData[colname];
											break;	
									}
									r.push(val);
								});
								rowsIn.push(r);
							}
							else{
								$.each(_columns2, function(idx, colname){
									var val = "";
									switch(colname){
										case "STT": 
											val = index2++;
											break;
										case "IsLocalForeign":
											if (rData[colname] == 1)
												val='<input class="hiden-input" value="1">' + "Nội";
											else
												val='<input class="hiden-input" value="2">' + "Ngoại";
											break;
										case "ClassID":
											if (rData[colname] == 1)
												val='<input class="hiden-input" value="1">' + "Nhập";
											else
												val='<input class="hiden-input" value="2">' + "Xuất";
											break;
										case "JobModeID":
											val = (rData[colname] == null) ? '' : '<input class="hiden-input" value="' + rData[colname] + '">' + rData['JobModeName'];
											break;
										case "MethodID":
											val = (rData[colname] == null) ? '' : '<input class="hiden-input" value="' + rData[colname] + '">' + rData['MethodName'];
											break;
										case "UnitID":
											val = (rData[colname] == null) ? '' : '<input class="hiden-input" value="' + rData[colname] + '">' + rData['UnitName'];
											break;
										default:
											val = (rData[colname] == null) ? '' : rData[colname];
											break;	
									}
									r.push(val);
								});
								rowsOut.push(r);
							}
						}
					}

					TblConten.waitingLoad();

		        	if (rowsIn.length > 0){
						TblConten.dataTable().fnAddData(rowsIn);
		        	}
		        	if (rowsOut.length > 0){
						TblConten.dataTable().fnAddData(rowsOut);
		        	}	
		        	//btn.button('reset');
				},
				error: function(err){
					console.log(err);
					//btn.button('reset');
				}
			});
		});


		let tblCustomer_col = [
			{ width: "80px", data: "STT", name: "STT", title: "STT", className: "text-center  editor-cancel", targets: 0 },
			{ data: "TaxCode", name: "TaxCode", title: "Mã số thuế", className: "text-center", targets: 1 },
			{ data: "CusName", name: "CusName", title: "Tên khách hàng", className: "text-center", targets: 2 },
			{ data: "Address", name: "Address", title: "Địa chỉ", className: "text-center data-type-numeric", targets: 3 },
			{ data: "PaymentTypeID", name: "PaymentTypeID", title: "Loại hình thanh toán", className: "text-center autocomplete", targets: 4 ,render:(dt,type,row)=>{
				switch (dt) {
					case 'M':
						return 'Thu ngay'
						break;
				
					case 'C':
						return 'Thu sau'
						break;

					default:
						return ''
						break;
				}
			}}
		]
		var dataTbl = $('#tblCustomer').newDataTable({
			scrollY: '55vh',
			columnDefs: tblCustomer_col,
			data: [],
			order: [[0, 'asc']],
			paging: false,
			keys: true,
			autoFill: {
				focus: 'focus',
			},
			select: true,
			rowReorder: false
		});
		$(document).on('click','#tblCustomer tbody tr',function(){
			$('#tblCustomer tr').removeClass('selected');
			$(this).addClass('selected');
		})
		$(document).on('click','#chooseCustomer',function(){
			$('#customer-modal').modal('show');
			$('#TaxCode').val('');
			$('#tblCustomer').DataTable().draw();
			setTimeout(()=>{
				$('#tblCustomer').DataTable().draw();
			},300);
			$.ajax({
				url: "/Order/ordDelivery/loadCustomers",
				dataType: 'json',
				data: {
					search: $('#tax_code').val().trim()
				},
				type: 'POST',
				success: function (data) {
					$('#tblCustomer').DataTable().rows().remove();
					if(data && data.data && data.data[0]){
						$('#tblCustomer').DataTable().rows.add(data.data.map((itm,ii)=>{return {...itm,STT:(ii+1)}}));
					}
				},
				error: function(err){
					console.log(err);
				}
			});
		})

		$(document).on('click','#apply-customer',function(){
			let row=$('#tblCustomer').DataTable().rows('.selected').data().toArray();
			if(row.length<=0) return toastr['error']('Chưa chọn khách hàng !');
			$('#tax_code').val(row[0].TaxCode);
			$('#TaxCode').val(row[0].TaxCode);
			$('#MoneyCredit').val(row[0].PaymentTypeID);
			$('#customer-modal').modal('hide');
			$.ajax({
				url: "/Order/ordDelivery/loadDiscount",
				dataType: 'json',
				data: {
					filter: {
						CusID: row[0].CusID
					}
				},
				type: 'POST',
				success: function (data) {
					$('#NoContact').html('');
					let html='';
					(data.data||[]).map(itm=>{
						html+=`<option value="${itm}"></option>`;
					})
				},
				error: function(err){
					console.log(err);
				}
			});
		});













		
	});
</script>  -->		$(document).on("dblclick", "#tblVessel tbody tr",  function(){
       		var VesselData 		= tblVessel.getSelectedRows().data().toArray()[0],
       			VoyageKey		= VesselData[_vesselColumns.indexOf("VoyageKey")],
       			VesselName 		= VesselData[_vesselColumns.indexOf("VesselName")],
       			InboundVoyage 	= VesselData[_vesselColumns.indexOf("InboundVoyage")],
       			OutboundVoyage 	= VesselData[_vesselColumns.indexOf("OutboundVoyage")],
       			InLane 			= VesselData[_vesselColumns.indexOf("InLane")],
       			OutLane 		= VesselData[_vesselColumns.indexOf("OutLane")],
       			ETA 			= VesselData[_vesselColumns.indexOf("ETA")],
       			ETD 			= VesselData[_vesselColumns.indexOf("ETD")];

       		$("#VoyageKey").val(VoyageKey);
       		$("#VesselName").val(VesselName + " | " + InboundVoyage + " | " + OutboundVoyage);
  




<script src="/assets/vendors/bootstrap-select/dist/js/bootstrap-select.min.js"></script>